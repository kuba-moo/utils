/*
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>
 *
 * Copyright (C) 2014 Jakub Kicinski <kubakici@wp.pl>
 */

float chi2_table[] = {
	/*   0 */    0.0,    3.841,   5.991,   7.815,   9.488,
	/*   5 */  11.070,  12.592,  14.067,  15.507,  16.919,
	/*  10 */  18.307,  19.675,  21.026,  22.362,  23.685,
	/*  15 */  24.996,  26.296,  27.587,  28.869,  30.144,
	/*  20 */  31.410,  32.671,  33.924,  35.172,  36.415,
	/*  25 */  37.652,  38.885,  40.113,  41.337,  42.557,
	/*  30 */  43.773,  44.985,  46.194,  47.400,  48.602,
	/*  35 */  49.802,  50.998,  52.192,  53.384,  54.572,
	/*  40 */  55.758,  56.942,  58.124,  59.304,  60.481,
	/*  45 */  61.656,  62.830,  64.001,  65.171,  66.339,
	/*  50 */  67.505,  68.669,  69.832,  70.993,  72.153,
	/*  55 */  73.311,  74.468,  75.624,  76.778,  77.931,
	/*  60 */  79.082,  80.232,  81.381,  82.529,  83.675,
	/*  65 */  84.821,  85.965,  87.108,  88.250,  89.391,
	/*  70 */  90.531,  91.670,  92.808,  93.945,  95.081,
	/*  75 */  96.217,  97.351,  98.484,  99.617, 100.749,
	/*  80 */ 101.879, 103.010, 104.139, 105.267, 106.395,
	/*  85 */ 107.522, 108.648, 109.773, 110.898, 112.022,
	/*  90 */ 113.145, 114.268, 115.390, 116.511, 117.632,
	/*  95 */ 118.752, 119.871, 120.990, 122.108, 123.225,
	/* 100 */ 124.342, 125.458, 126.574, 127.689, 128.804,
	/* 105 */ 129.918, 131.031, 132.144, 133.257, 134.369,
	/* 110 */ 135.480, 136.591, 137.701, 138.811, 139.921,
	/* 115 */ 141.030, 142.138, 143.246, 144.354, 145.461,
	/* 120 */ 146.567, 147.674, 148.779, 149.885, 150.989,
	/* 125 */ 152.094, 153.198, 154.302, 155.405, 156.508,
	/* 130 */ 157.610, 158.712, 159.814, 160.915, 162.016,
	/* 135 */ 163.116, 164.216, 165.316, 166.415, 167.514,
	/* 140 */ 168.613, 169.711, 170.809, 171.907, 173.004,
	/* 145 */ 174.101, 175.198, 176.294, 177.390, 178.485,
	/* 150 */ 179.581, 180.676, 181.770, 182.865, 183.959,
	/* 155 */ 185.052, 186.146, 187.239, 188.332, 189.424,
	/* 160 */ 190.516, 191.608, 192.700, 193.791, 194.883,
	/* 165 */ 195.973, 197.064, 198.154, 199.244, 200.334,
	/* 170 */ 201.423, 202.513, 203.602, 204.690, 205.779,
	/* 175 */ 206.867, 207.955, 209.042, 210.130, 211.217,
	/* 180 */ 212.304, 213.391, 214.477, 215.563, 216.649,
	/* 185 */ 217.735, 218.820, 219.906, 220.991, 222.076,
	/* 190 */ 223.160, 224.245, 225.329, 226.413, 227.496,
	/* 195 */ 228.580, 229.663, 230.746, 231.829, 232.912,
	/* 200 */ 233.994, 235.077, 236.159, 237.240, 238.322,
	/* 205 */ 239.403, 240.485, 241.566, 242.647, 243.727,
	/* 210 */ 244.808, 245.888, 246.968, 248.048, 249.128,
	/* 215 */ 250.207, 251.286, 252.365, 253.444, 254.523,
	/* 220 */ 255.602, 256.680, 257.758, 258.837, 259.914,
	/* 225 */ 260.992, 262.070, 263.147, 264.224, 265.301,
	/* 230 */ 266.378, 267.455, 268.531, 269.608, 270.684,
	/* 235 */ 271.760, 272.836, 273.911, 274.987, 276.062,
	/* 240 */ 277.138, 278.213, 279.288, 280.362, 281.437,
	/* 245 */ 282.511, 283.586, 284.660, 285.734, 286.808,
};

float chi2_table_big[] = {
	/*  250 */  287.882, 341.395, 394.626, 447.632, 500.456,
	/*  500 */  553.127, 605.667, 658.094, 710.421, 762.661,
	/*  750 */  814.822, 866.911, 918.937, 970.904, 1022.816,
	/* 1000 */ 1074.679,
};

unsigned long chi2_table_len = sizeof(chi2_table)/sizeof(chi2_table[0]);
unsigned long chi2_table_big_len =
	sizeof(chi2_table_big)/sizeof(chi2_table_big[0]);

float chi2_read(unsigned df)
{
	if (df < chi2_table_len)
		return chi2_table[df];

	df -= chi2_table_len;
	df /= 50;

	if (df < chi2_table_big_len)
		return chi2_table_big[df];

	return -1;
}
